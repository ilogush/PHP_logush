# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –Ω–∞ WMRS —Ö–æ—Å—Ç–∏–Ω–≥

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –î–æ—Å—Ç—É–ø –∫ ISPmanager –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- FTP –¥–æ—Å—Ç—É–ø (–≤–∞—à –ª–æ–≥–∏–Ω / –≤–∞—à –ø–∞—Ä–æ–ª—å)
- MySQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤–∞—à–∞ –±–∞–∑–∞ / –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å / –≤–∞—à –ø–∞—Ä–æ–ª—å)
- PHP 8.2+

---

## üöÄ –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

### –ß–µ—Ä–µ–∑ FTP (FileZilla, Cyberduck –∏ —Ç.–¥.)

```
–•–æ—Å—Ç: <FTP_HOST>
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <FTP_USER>
–ü–∞—Ä–æ–ª—å: <FTP_PASS>
–ü–æ—Ä—Ç: 21
```

–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –≤ `/public_html/`:

```
/public_html/
‚îú‚îÄ‚îÄ public/          ‚Üí —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.php
‚îÇ   ‚îú‚îÄ‚îÄ .htaccess
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îî‚îÄ‚îÄ images/
‚îú‚îÄ‚îÄ src/             ‚Üí –ø–∞–ø–∫–∞ src/
‚îú‚îÄ‚îÄ views/           ‚Üí –ø–∞–ø–∫–∞ views/
‚îú‚îÄ‚îÄ storage/         ‚Üí –ø–∞–ø–∫–∞ storage/
‚îú‚îÄ‚îÄ scripts/         ‚Üí –ø–∞–ø–∫–∞ scripts/
‚îî‚îÄ‚îÄ .env             ‚Üí —Å–æ–∑–¥–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example
```

**–í–∞–∂–Ω–æ:** –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–∞–π—Ç–∞ –¥–æ–ª–∂–Ω–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ `/public_html/public/`

---

## üîß –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
APP_DEBUG=0
DB_HOST=localhost
DB_PORT=3306
DB_NAME=logush
DB_USER=logush
DB_PASSWORD=change_me
DB_CHARSET=utf8mb4

# FTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
FTP_HOST=ns88.wmrs.ru
FTP_USER=change_me
FTP_PASS=change_me
FTP_PORT=21
FTP_REMOTE_PATH=/public_html
```

---

## üóÑÔ∏è –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ß–µ—Ä–µ–∑ ISPmanager:

1. –û—Ç–∫—Ä—ã—Ç—å "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" ‚Üí "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MySQL"
2. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É: `logush`
3. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `logush` (–ø–∞—Ä–æ–ª—å: —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –≤ –ø–∞–Ω–µ–ª–∏)
4. –î–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ –±–∞–∑—É

### –ß–µ—Ä–µ–∑ SSH (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):

```bash
cd /var/www/<USER>/data

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
php scripts/migrate.php

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
php scripts/seed.php

# –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∞
php scripts/create_admin.php
```

### –ß–µ—Ä–µ–∑ –≤–µ–± (–µ—Å–ª–∏ SSH –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω):

–°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª `public/setup.php`:

```php
<?php
require __DIR__ . '/../src/bootstrap.php';

$baseDir = dirname(__DIR__);
$pdo = Logush\Database::connectFromEnv();

if (!$pdo) {
    die('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î');
}

// –ú–∏–≥—Ä–∞—Ü–∏–∏
Logush\DatabaseMigrator::migrate($pdo);
echo "‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã<br>";

// –°–∏–¥—ã
$store = new Logush\DataStore($baseDir);
$store->seed();
echo "‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã<br>";

echo "<br>–£–¥–∞–ª–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏!";
```

–û—Ç–∫—Ä—ã—Ç—å `https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/setup.php`, –∑–∞—Ç–µ–º —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª.

---

## üîê –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–ß–µ—Ä–µ–∑ FTP –∏–ª–∏ SSH —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞:

```bash
chmod 755 storage/uploads
chmod 755 storage/data
chmod 755 storage/backups
chmod 755 storage/ssr
chmod 644 .env
```

---

## ‚öôÔ∏è –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PHP (ISPmanager)

### –í–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

- ‚úÖ PDO
- ‚úÖ PDO_MySQL
- ‚úÖ mbstring
- ‚úÖ fileinfo
- ‚úÖ gd –∏–ª–∏ imagick

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å php.ini:

```ini
memory_limit = 256M
max_execution_time = 60
upload_max_filesize = 8M
post_max_size = 10M

; OPcache (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
opcache.enable = 1
opcache.memory_consumption = 128
opcache.interned_strings_buffer = 8
opcache.max_accelerated_files = 10000
opcache.revalidate_freq = 60
```

---

## üåê –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞

### –í ISPmanager:

1. "WWW-–¥–æ–º–µ–Ω—ã" ‚Üí –í—ã–±—Ä–∞—Ç—å –¥–æ–º–µ–Ω
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `/public_html/public`
3. –í–∫–ª—é—á–∏—Ç—å SSL (Let's Encrypt)

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .htaccess:

–§–∞–π–ª `public/.htaccess` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ PHP:

```apache
FCGIWrapper /var/www/<USER>/data/php-bin-isp-php82/php .php
```

–ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è PHP –¥—Ä—É–≥–∞—è, –∏–∑–º–µ–Ω–∏—Ç—å `php82` –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é.

---

## ‚úÖ –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 1. –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–º–∏–Ω–∫—É:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/login
```

–õ–æ–≥–∏–Ω: admin@logush.ru  
–ü–∞—Ä–æ–ª—å: admin123 (–∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞!)

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:

–°–æ–∑–¥–∞—Ç—å `public/check.php`:

```php
<?php
require __DIR__ . '/../src/bootstrap.php';
$baseDir = dirname(__DIR__);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
$store = new Logush\DataStore($baseDir);
$start = microtime(true);
$products1 = $store->read('products');
$time1 = (microtime(true) - $start) * 1000;

$start = microtime(true);
$products2 = $store->read('products');
$time2 = (microtime(true) - $start) * 1000;

echo "–ü–µ—Ä–≤–æ–µ —á—Ç–µ–Ω–∏–µ: " . round($time1, 2) . "ms<br>";
echo "–í—Ç–æ—Ä–æ–µ —á—Ç–µ–Ω–∏–µ: " . round($time2, 2) . "ms (–∫—ç—à)<br>";
echo "–£—Å–∫–æ—Ä–µ–Ω–∏–µ: " . round($time1 / max($time2, 0.01), 1) . "x<br>";

if ($time2 < 1) {
    echo "<br>‚úÖ –ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!";
} else {
    echo "<br>‚ö†Ô∏è –ö—ç—à –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ª—É—á—à–µ";
}

echo "<br><br>–£–¥–∞–ª–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏!";
```

–û—Ç–∫—Ä—ã—Ç—å `https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/check.php`, –∑–∞—Ç–µ–º —É–¥–∞–ª–∏—Ç—å.

---

## üîÑ –®–∞–≥ 8: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á (Cron)

### –í ISPmanager ‚Üí "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á":

#### 1. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00):
```bash
0 3 * * * cd /var/www/<USER>/data && php scripts/backup_db.php
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ):
```bash
0 4 * * 0 cd /var/www/<USER>/data && php scripts/optimize_db.php
```

–°–æ–∑–¥–∞—Ç—å `scripts/optimize_db.php`:

```php
<?php
require __DIR__ . '/../src/bootstrap.php';

$pdo = Logush\Database::connectFromEnv();
if (!$pdo) {
    exit(1);
}

$tables = ['products', 'categories', 'colors', 'sizes', 'orders', 'quotes', 'users', 'settings'];
foreach ($tables as $table) {
    $pdo->exec("OPTIMIZE TABLE $table");
    echo "Optimized $table\n";
}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫:

```
storage/php_errors.log
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å slow queries MySQL:

–í ISPmanager ‚Üí "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" ‚Üí "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É:

```bash
php scripts/check_optimization.php
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ 500:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `storage/php_errors.log`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–∞–º
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ PHP –≤ `.htaccess`

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `.env` —Ñ–∞–π–ª
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î –≤ ISPmanager
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å `DB_HOST=localhost` –≤–º–µ—Å—Ç–æ `127.0.0.1`

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∫–ª—é—á–µ–Ω –ª–∏ OPcache
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `php scripts/check_optimization.php`
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ë–î
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã: `SHOW INDEX FROM products`

### –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ `storage/uploads`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `.htaccess` –≤ `public/`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –≤ –∫–æ–¥–µ: `/api/upload?key=...`

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

1. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞
2. ‚úÖ –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (`setup.php`, `check.php`)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `.env` –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –≤–µ–±
4. ‚úÖ –í–∫–ª—é—á–∏—Ç—å HTTPS (SSL)
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

```bash
# .env –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/.env
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 403 Forbidden

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/storage/
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 403 Forbidden
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `WMRS_OPTIMIZATION.md`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `storage/php_errors.log`
3. –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WMRS: https://wmrs.ru/support

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–°–∞–π—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞ WMRS —Ö–æ—Å—Ç–∏–Ω–≥–µ.

–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 100-200ms
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: 10-20MB
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 100+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
